---
title: AWS Application Load Balancer with WAF
date: 2025-12-15 07:30:00 +0700
categories: [Cloud, Amazon Web Services (AWS)]
tags: [AWS]
---

AWS Elastic Load Balancing (ELB) automatically distributes incoming application traffic across multiple targets—such as EC2 instances, containers, and IP addresses—to ensure high availability and robust fault tolerance.

> * Application Load Balancer (ALB): Operates at Layer 7 (HTTP/HTTPS) and is best suited for modern web applications, offering advanced request routing based on content like URL paths, headers, or hostnames.
> * Network Load Balancer (NLB): Operates at Layer 4 (TCP/UDP) and is designed for extreme performance, capable of handling millions of requests per second with ultra-low latency.
> * Gateway Load Balancer (GWLB): Combines a transparent network gateway (Layer 3) with load balancing (Layer 4) to easily deploy, scale, and manage fleets of third-party virtual appliances like firewalls and intrusion detection systems.

<br>

## Application Load Balancer

Here we have 2 linux instances serving web on port 8080

![x](/static/2025-15-15-aws-alb/01.png)

![x](/static/2025-15-15-aws-alb/02.png)

<br>

We'll create a Target Group to contain those 2 instances so we can later use it as load balancing target. Here we select Protocol HTTP on port 8080

![x](/static/2025-15-15-aws-alb/03.png)

<br>

Then we select the VPC that the instances are in, and select the health check target protocol & directory

![x](/static/2025-15-15-aws-alb/04.png)

<br>

Next we select the 2 linux instances

![x](/static/2025-15-15-aws-alb/05.png)

<br>

Review and hit Create

![x](/static/2025-15-15-aws-alb/06.png)

<br>

Now we have a Target Group

![x](/static/2025-15-15-aws-alb/07.png)

![x](/static/2025-15-15-aws-alb/08.png)

<br>

After that, we'll create the Application Load Balancer

![x](/static/2025-15-15-aws-alb/09.png)

<br>

Give it name and select the scheme

![x](/static/2025-15-15-aws-alb/10.png)

<br>

Then select the VPC, btw the load balancer requires us to have at least 2 different subnets on 2 different zones, thats why we added a second 'placeholder' subnet

![x](/static/2025-15-15-aws-alb/11.png)

<br>

Next on the listener, we'll select HTTP on port 80 with the target being the Target Group we created earlier

![x](/static/2025-15-15-aws-alb/12.png)

<br>

Review and hit Create

![x](/static/2025-15-15-aws-alb/13.png)

<br>

After couple minutes, the ALB is up and running

![x](/static/2025-15-15-aws-alb/14.png)

![x](/static/2025-15-15-aws-alb/15.png)

<br>

And when we acces the Load Balancer DNS Name, we are being served by both linux instances thats being load balanced

![x](/static/2025-15-15-aws-alb/16.png)

![x](/static/2025-15-15-aws-alb/17.png)

<br>

## Web Application Firewall

AWS WAF sits on our ALB to filter traffic using customizable rules before it hits our servers. In this lab, we will enforce **geo-blocking** to deny access from specific countries and **rate limiting** to automatically ban IPs that send too many requests.

First we will create a new Protection Pack (Web ACL) that protects our ALB

![x](/static/2025-15-15-aws-alb/19.png)

![x](/static/2025-15-15-aws-alb/18.png)

<br>

For the first rule, we will select a custom rule and then Geo-based rule

![x](/static/2025-15-15-aws-alb/20.png)

![x](/static/2025-15-15-aws-alb/21.png)

<br>

Then we create a rule to block any traffic orignating from Russia & China

![x](/static/2025-15-15-aws-alb/22.png)

<br>

Next for the second rule, we will select Rate-based rule

![x](/static/2025-15-15-aws-alb/23.png)

<br>

And create throttling rule to limit traffic to have max rate limit of 10 requests per minute

![x](/static/2025-15-15-aws-alb/24.png)

<br>

Now we have both our rules configured inside this Web ACL

![x](/static/2025-15-15-aws-alb/25.png)

<br>

Finally give it name and hit create

![x](/static/2025-15-15-aws-alb/26.png)

![x](/static/2025-15-15-aws-alb/27.png)

<br>

Now if we try accessing the ALB from Russia or China, we will be denied

![x](/static/2025-15-15-aws-alb/28.png)

<br>

We can see this report on the WAF Dashboard

![x](/static/2025-15-15-aws-alb/29.png)

<br>

And if we try to brute force the ALB we will get error 429 Too Many Requests

![x](/static/2025-15-15-aws-alb/30.png)

<br>

We can also see this report on the dashboard

![x](/static/2025-15-15-aws-alb/31.png)

<br>









