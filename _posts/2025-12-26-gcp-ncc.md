---
title: GCP Network Connectivity Center (NCC)
date: 2025-12-26 07:30:00 +0700
categories: [Cloud, Google Cloud Platform (GCP)]
tags: [GCP]
---

In this lab, we will configure Network Connectivity Center (NCC) Hub that serve as a global control plane for managing network connectivity across multiple VPCs. By integrating a FortiGate VM as a Router Appliance spoke, we use the FortiGate to function as a centralized security gateway for all internet traffic.

![x](/static/2025-12-26-gcp-ncc/00.png)

## VPC

First we create the all the VPCs that we need for this lab

![x](/static/2025-12-26-gcp-ncc/01.png)

<br>

Make sure the spoke VPCs (vpc-a & vpc-b) do not have static default route, we will use BGP later on for this

![x](/static/2025-12-26-gcp-ncc/01a.png)

<br>

Then deploy the Fortigate Firewall to have 2 interfaces, the uplink to the ext-vpc with internet access and the downlink to the transit-vpc

![x](/static/2025-12-26-gcp-ncc/01b.png)

![x](/static/2025-12-26-gcp-ncc/02.png)

<br>

## Cloud Router

After that we create the Cloud Router on vpc-transit with BGP ASN 65001

![x](/static/2025-12-26-gcp-ncc/03.png)

<br>

On Advertised Routes, we will configure this router to advertise both vpc-a & vpc-b subnets

![x](/static/2025-12-26-gcp-ncc/03a.png)

<br>

Now we have our Cloud Router configured

![x](/static/2025-12-26-gcp-ncc/04.png)

<br>

## NCC Hub

Next we create a NCC Hub, for simplicity we will use the Mesh Topology

![x](/static/2025-12-26-gcp-ncc/05.png)


> * Mesh Topology : All spokes belong to a single group where every VPC or hybrid spoke can communicate directly with every other spoke in a many-to-many relationship, optimizing for low latency.
> * Star Topology: Spokes are organized into "Center" and "Edge" groups to enforce network segmentation; Center spokes can communicate with all other spokes, while Edge spokes can only communicate with those in the Center group.
> * Hybrid Inspection Topology: A specialized configuration supported only with NCC Gateway that mandates all cloud-to-cloud and hybrid traffic be steered through a centralized set of Next-Generation Firewalls (NGFWs) for deep, stateful packet inspection.

<br>

Next give it name

![x](/static/2025-12-26-gcp-ncc/06.png)

<br>

And lastly here we add the 3 spokes, first two are the vpc-a & vpc-b

![x](/static/2025-12-26-gcp-ncc/07.png)

<br>

And the last one is a Router Appliance that points to the Fortigate Firewall

![x](/static/2025-12-26-gcp-ncc/08.png)

<br>

Here we have all 3 spokes configured, hit create

![x](/static/2025-12-26-gcp-ncc/09.png)

![x](/static/2025-12-26-gcp-ncc/10.png)

<br>

Next on Spokes, open the fortigate spoke

![x](/static/2025-12-26-gcp-ncc/11.png)

<br>

Here we will configure the BGP session with our Cloud Router

![x](/static/2025-12-26-gcp-ncc/12.png)

<br>

Select the transit-router

![x](/static/2025-12-26-gcp-ncc/13.png)

<br>

Then configure the BGP session

![x](/static/2025-12-26-gcp-ncc/14.png)

<br>

We are mandated to have 2 bgp peers so here we configure 2, even though we will only use 1 for simplicity

![x](/static/2025-12-26-gcp-ncc/15.png)

<br>

Here after the BGP sessions are all configured

![x](/static/2025-12-26-gcp-ncc/16.png)

<br>

## Fortigate 

On Fortigate we will also configure the BGP session

```
config router bgp
    set as 65002
    set router-id 192.168.1.2
    config neighbor
        edit "192.168.1.3"
            set remote-as 65001
            set ebgp-enforce-multihop enable
            set soft-reconfiguration enable
        next
    end
end
```

<br>

And now the BGP session has been established, we can see Fortigate is advertising and receiving the correct subnets from the Cloud Router

![x](/static/2025-12-26-gcp-ncc/17.png)

<br>

Back on Cloud Router, we can also see the BGP peer is now up

![x](/static/2025-12-26-gcp-ncc/18.png)

<br>

And it's also advertising and receiving the correct subnets from Fortigate

![x](/static/2025-12-26-gcp-ncc/19.png)

![x](/static/2025-12-26-gcp-ncc/20.png)

<br>

And on the Hub side should also show the correct routing

![x](/static/2025-12-26-gcp-ncc/21.png)

<br>

## Testing

Now we spin up small vm on each vpc-a & vpc-b

![x](/static/2025-12-26-gcp-ncc/22.png)

<br>

On vm-a, we can ping the vm-b successfully and we can also access the internet

![x](/static/2025-12-26-gcp-ncc/23.png)

<br>

Same goes from vm-b, connectivity to vm-a and to internet is also working

![x](/static/2025-12-26-gcp-ncc/24.png)

<br>

On Fortigate, we can see the traffic coming in from vm-a & vm-b going out to the internet

![x](/static/2025-12-26-gcp-ncc/25.png)

<br>



