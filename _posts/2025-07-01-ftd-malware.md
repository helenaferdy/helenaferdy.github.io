---
title: Cisco FTD Malware & File Policy
date: 2025-07-01 07:30:00 +0700
categories: [Security, Cisco Firepower Threat Defense (FTD)]
tags: [FTD]
---

Cisco FTD's **Malware & File Policy** is designed to detect and control file transfers across the network and protect against malware. It inspects files based on type, size, and direction (upload/download), and can block, allow, or log them. When enabled with **AMP (Advanced Malware Protection)**, it uses Cisco’s global threat intelligence (Talos) to perform **reputation checks**, **sandbox analysis**, and **retrospective detection**—allowing the system to detect and respond to files that later prove malicious. This helps organizations stop malware at the gateway before it reaches endpoints.

<br>

## Enabling SSL Decrytion

> Enabling **SSL decryption** is essential for inspecting **HTTPS traffic**, which is encrypted by design. Without decryption, FTD cannot analyze the contents of the traffic, allowing threats such as malware or data exfiltration to go undetected. By decrypting SSL, FTD can **inspect encrypted sessions**, enforce security policies, and **detect threats hidden inside HTTPS traffic**.

To enable SSL Decryption, on Policies >> Access Control >> Decryption, create new policy

![x](/static/2025-07-01-ftd-malware/01.png)

<br>

Here we will generate a new CSR for Certificate

![x](/static/2025-07-01-ftd-malware/02.png)

![x](/static/2025-07-01-ftd-malware/03.png)

<br>

Sign the CSR on CA Server with template Subordinate Certificate Authority

![x](/static/2025-07-01-ftd-malware/04.png)

<br>

Then install the signed certificate

![x](/static/2025-07-01-ftd-malware/05.png)

<br>

And now we have a working and running Decyption Policy

![x](/static/2025-07-01-ftd-malware/06.png)

<br>

On client side, when we try accessing internet now the certificate will show verified by FTD 

![x](/static/2025-07-01-ftd-malware/07.png)

<br>

## Configuring Malware & File Policy

Right now we dont have any Malware & File Policy enabled, allowing clients to download any malware on the internet

![x](/static/2025-07-01-ftd-malware/08.png)

<br>

Create a new Malware Policy, here FTD has 4 main modes for action, we will select 'Block Malware' here

![x](/static/2025-07-01-ftd-malware/08a.png)

> * "Detect Files" is for visibility and logging without intervention. <br>
> * "Block Files" is for preventing specific file types from being transferred, regardless of whether they are malicious. <br>
> * "Malware Cloud Lookup" is for identifying known malware using cloud intelligence. <br>
> * "Block Malware" is for actively preventing known malicious files from being transferred, often leveraging cloud intelligence for identification. <br>

<br>

We will enable all submenu of actions and select all types of file categories

![x](/static/2025-07-01-ftd-malware/09.png)

> * Spero Analysis for MSEXE: Statically analyzes Microsoft executable files for malware indicators. <br>
> * Dynamic Analysis: Executes suspicious files in a safe, isolated environment to observe their behavior. <br>
> * Capacity Handling: Manages analysis queue load to prevent system overload while prioritizing security. <br>
> * Local Malware Analysis: Performs on-device malware detection using built-in signatures and intelligence. <br>
> * Reset Connection: Terminates the network connection immediately when malware is detected and blocked. <br>

<br>

Here's how the policy end up looking

![x](/static/2025-07-01-ftd-malware/10.png)

<br>

Finally we can attach the Malware Policy inside a Policy Rule

![x](/static/2025-07-01-ftd-malware/11.png)

<br>

Now if we try to download the same malware, we will get a connection reset

![x](/static/2025-07-01-ftd-malware/12.png)

<br>

We can see the connection event and malware summary for the blocked traffic

![x](/static/2025-07-01-ftd-malware/13.png)

![x](/static/2025-07-01-ftd-malware/14.png)

<br>

Other than web traffic, this policy will also block any other traffic that contains malware, including file share transfer over SMB

![x](/static/2025-07-01-ftd-malware/15.png)

![x](/static/2025-07-01-ftd-malware/16.png)

<br>




































