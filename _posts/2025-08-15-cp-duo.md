---
title: Cisco Duo with Check Point VPN
date: 2025-08-15 07:30:00 +0700
categories: [Security, Ciso Duo]
tags: [Check Point, Duo]
---

Cisco Duo adds multi-factor authentication (MFA) to secure Check Point Remote Access VPN logins. When a user connects to the Check Point VPN, Duo verifies their identity with a second factor before granting access, ensuring stronger protection against compromised credentials.

![x](/static/2025-08-15-cp-duo/00.png)

<br>

## VPN with Domain Users

Here we have a working [Check Point Remote Access VPN](https://helenaferdy.blog/posts/checkpoint-ssl-remote-vpn/) that uses local users to log in

![x](/static/2025-08-15-cp-duo/01.png)

<br>

Before enabling MFA, first we have to enable VPN login using AD users, lets enable Identity Awareness Blade

![x](/static/2025-08-15-cp-duo/02.png)

![x](/static/2025-08-15-cp-duo/03.png)

<br>

Next create a new LDAP Group that points to the newly created AD LDAP Unit

![x](/static/2025-08-15-cp-duo/04.png)

<br>

Then add the LDAP Group as a participant in the Remote Access VPN Community, this will allow AD Users to login to VPN

![x](/static/2025-08-15-cp-duo/05.png)

<br>

And lastly we also need to add policy for the AD users to access internal network

![x](/static/2025-08-15-cp-duo/06.png)

<br>

Now we can login to VPN using AD users (domuser1@helena.gg)

![x](/static/2025-08-15-cp-duo/07.png)

![x](/static/2025-08-15-cp-duo/08.png)

<br>

## VPN with Duo MFA

Lets enable Duo to be used as MFA, we'll pretty much follow a similar implementation as [this one](https://helenaferdy.blog/posts/duo-asa/), first we make sure the user is present on Duo wth same username as the one on AD

![x](/static/2025-08-15-cp-duo/09.png)

<br>

Then we add a Protected Application, Duo already provides a template for Check Point VPN so lets use that

![x](/static/2025-08-15-cp-duo/10.png)

<br>

Copy all the necessary credentials

![x](/static/2025-08-15-cp-duo/11.png)

<br>

And configure it on the Duo Proxy Server

![x](/static/2025-08-15-cp-duo/12.png)

<br>

Now we go back to Check Point, lets create a new RADIUS Server Object pointing to Duo Proxy Server

![x](/static/2025-08-15-cp-duo/13.png)

<br>

Then on the LDAP Account Unit, enable Radius Authentication Scheme and point it to the previously created RADIUS Object

![x](/static/2025-08-15-cp-duo/14.png)

<br>

And thats pretty much it, if we try connecting to VPN using AD users, we will now be prompted a Duo MFA

![x](/static/2025-08-15-cp-duo/15.png)

![x](/static/2025-08-15-cp-duo/16.png)

![x](/static/2025-08-15-cp-duo/17.png)

<br>

But if we login using local users, which we still allow on the Community Configuration, we will connect directly without MFA

![x](/static/2025-08-15-cp-duo/18.png)

![x](/static/2025-08-15-cp-duo/19.png)

<br>






