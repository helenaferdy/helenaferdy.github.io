---
title: Cisco Duo with Fortigate VPN
date: 2025-08-19 07:30:00 +0700
categories: [Security, Cisco Duo]
tags: [Fortinet, Duo]
---

FortiGate Remote Access VPN with Cisco Duo MFA works by integrating Duoâ€™s two-factor authentication into the VPN login flow. When a user connects through SSL-VPN or IPsec VPN on the FortiGate, they first authenticate with their primary credentials, then Duo pushes a second-factor challenge before granting access. This ensures only verified users can establish a secure VPN session.


![x](/static/2025-08-19-forti-duo/00.png)

<br>

## Enabling Duo MFA

Here we have a working [Fortigate IPSec Remote Access VPN](https://helenaferdy.github.io/posts/forti-vpn/) using local users to log in

![x](/static/2025-08-19-forti-duo/01.png)

<br>

To enable Duo, we'll pretty much follow a similar implementation as [this one](https://helenaferdy.github.io/posts/duo-asa/), first we make sure the user is present on Duo with same username as the one on AD

![x](/static/2025-08-19-forti-duo/02.png)

<br>

Then we add a Protected Application, Duo already provides a template for Fortigate SSL VPN so lets use that, even though actually we use IPSec but the authentication process is the same

![x](/static/2025-08-19-forti-duo/03.png)

<br>

Copy all the necessary credentials

![x](/static/2025-08-19-forti-duo/04.png)

<br>

And configure it on the Duo Proxy Server

![x](/static/2025-08-19-forti-duo/05.png)

<br>

Next on the Fortigate, create a new Radius Server pointing to the Duo Proxy Server

![x](/static/2025-08-19-forti-duo/06.png)

<br>

We can also test the MFA right from this menu 

![x](/static/2025-08-19-forti-duo/07.png)

<br>

Then add the newly created Radius Object to the VPN User Group thats used on the VPN configuration

![x](/static/2025-08-19-forti-duo/08.png)

<br>

And we also increase the radius timeout to give users time to approve the MFA prompt

![x](/static/2025-08-19-forti-duo/09.png)

<br>

And now if we connect to VPN using AD users, we'll be prompted a Duo MFA

![x](/static/2025-08-19-forti-duo/10.png)

![x](/static/2025-08-19-forti-duo/11.png)

![x](/static/2025-08-19-forti-duo/12.png)

<br>

We can still connect to VPN using local users with no MFA because we still allow this user on the VPN Group

![x](/static/2025-08-19-forti-duo/01.png)






















