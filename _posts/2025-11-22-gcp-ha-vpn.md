---
title: GCP HA VPN with Check Point
date: 2025-11-22 07:30:00 +0700
categories: [Cloud, Google Cloud Platform (GCP)]
tags: [GCP, Check Point]
---

In this lab, we build a route-based HA VPN between GCP and a Check Point Firewall, using VTI and eBGP to exchange routes dynamically. Unlike [Classic VPN](https://helenaferdy.github.io/posts/gcp-classic-vpn/), which is a policy-based VPN that uses encryption domains to define interesting traffic, HA VPN uses dynamic routing with Cloud Router and BGP to advertise and learn prefixes automatically.

<br>

## Configuring VPC

Here we'll use the VPN-VPC on the 10.60.0.0/24 subnet

![x](/static/2025-11-22-gcp-ha-vpn/01.png)

<br>

## Configuring Cloud Router

Next we set up a Cloud Router as our virtual router on GCP, here we attach it to our VPC and give a BGP AS Number of 65001, and configure it to advertise all known networks

![x](/static/2025-11-22-gcp-ha-vpn/02.png)

![x](/static/2025-11-22-gcp-ha-vpn/03.png)

<br>

## Configuring HA VPN

Next we configure the HA VPN

![x](/static/2025-11-22-gcp-ha-vpn/04.png)

<br>

Here we give it name and associate it with our VPC.

![x](/static/2025-11-22-gcp-ha-vpn/05.png)

<br>

On here we setup tunnel to our On-premise Check Point firewall

![x](/static/2025-11-22-gcp-ha-vpn/06.png)

<br>

The peer check point object contains the public IP Address of the firewall, keep in mind this device is sitting behind NAT and is not directly accessible by the public IP

![x](/static/2025-11-22-gcp-ha-vpn/07.png)

<br>

Scroll down to the routing options we select the Cloud Router and set up the Pre-shared Key

![x](/static/2025-11-22-gcp-ha-vpn/08.png)

<br>

Then on cipher options, we'd just select the default option for simplicity

![x](/static/2025-11-22-gcp-ha-vpn/09.png)

<br>

Next on BGP sessions, we configure the peer BGP on the On-prem CP that uses AS Number 65002

![x](/static/2025-11-22-gcp-ha-vpn/10.png)

![x](/static/2025-11-22-gcp-ha-vpn/11.png)

<br>

And finally on the summary page, we can download our configuration to be used to configure on the on-prem side

![x](/static/2025-11-22-gcp-ha-vpn/12.png)

![x](/static/2025-11-22-gcp-ha-vpn/13.png)

<br>

This VPN Wizard automatically creates these 3 configurations

![x](/static/2025-11-22-gcp-ha-vpn/14.png)

![x](/static/2025-11-22-gcp-ha-vpn/15.png)

![x](/static/2025-11-22-gcp-ha-vpn/16.png)

<br>

## Configuring Check Point VPN

On Check Point side, we create a new Interoperable Device named GCP_Tunnel1 with GCP's public IP Address

![x](/static/2025-11-22-gcp-ha-vpn/17.png)

<br>

On Topology, we make sure to use Empty Group on the VPN Domain so the VPN will use routing table to decide which traffic will be encrypted

![x](/static/2025-11-22-gcp-ha-vpn/18.png)

<br>

Next we create a Star Community selecting our CP as Center Gateways and GCP as Satellite Gateways

![x](/static/2025-11-22-gcp-ha-vpn/19.png)

<br>

Then we configure the ciphers following the supported setup by GCP

![x](/static/2025-11-22-gcp-ha-vpn/20.png)

<br>

Next we enable Permanent Tunnels

![x](/static/2025-11-22-gcp-ha-vpn/21.png)

<br>

And finally we configure the Pre-share Key

![x](/static/2025-11-22-gcp-ha-vpn/22.png)

<br>

And we also add a rule policy to allow traffic going between the 2 subnets

![x](/static/2025-11-22-gcp-ha-vpn/23.png)

<br>

After that, we create a Tunnel Interface with peer name following the Interoperable Device name and IP Addressing following the downloaded configuration from GCP

![x](/static/2025-11-22-gcp-ha-vpn/24.png)

<br>

And we enable BGP to receive and advertise routes between GCP and On-premise

![x](/static/2025-11-22-gcp-ha-vpn/25.png)

![x](/static/2025-11-22-gcp-ha-vpn/26.png)

<br>

Lastly we import the interface so it shows up on Smart Console, and that should wrap up the configurations

![x](/static/2025-11-22-gcp-ha-vpn/27.png)

<br>

## Verifying VPN

On GCP side, we can see both Tunnel and BGP sessions are established

![x](/static/2025-11-22-gcp-ha-vpn/28.png)

<br>

Same goes if we verify it on the Check Point side

![x](/static/2025-11-22-gcp-ha-vpn/29.png)

<br>

On GCP's Cloud Router, we verify that it's advertising the 10.60.0.0/24 to BGP

![x](/static/2025-11-22-gcp-ha-vpn/30.png)

<br>

And it's also receiving 10.21.0.0/24 from BGP

![x](/static/2025-11-22-gcp-ha-vpn/31.png)

<br>

Same goes with CP, the BGP session has successfully received 10.60.0.0/24 from GCP and advertise 10.21.0.0/24 to GCP

![x](/static/2025-11-22-gcp-ha-vpn/32.png)

<br>

And we're also able to connect between the two hosts on GCP and On-prem

![x](/static/2025-11-22-gcp-ha-vpn/33.png)

![x](/static/2025-11-22-gcp-ha-vpn/34.png)

<br>

With logs showing up on CP verifying VPN and BGP connections are working perfectly

![x](/static/2025-11-22-gcp-ha-vpn/35.png)

<br>

























